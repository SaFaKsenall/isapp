<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    <script src="assets/js/theme-settings.js" type="module" defer></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .navbar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info {
            color: white;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logout-btn {
            background: transparent;
            border: 2px solid white;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: white;
            color: #764ba2;
        }

        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
        }

        .welcome-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .welcome-title {
            font-size: 2rem;
            color: #333;
            margin-bottom: 1.5rem;
        }

        .user-details {
            display: grid;
            gap: 1rem;
        }

        .detail-item {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1rem;
        }

        .detail-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .detail-value {
            color: #333;
            font-size: 1.1rem;
            word-break: break-word;
        }

        /* Yeni stiller */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 250px;
            background: #1a237e; /* Daha koyu lacivert */
            padding: 2rem 1rem;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0 1rem;
            margin-bottom: 2rem;
        }

        .sidebar-header .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a237e;
        }

        .sidebar-header .user-name {
            font-weight: 600;
            color: #ffffff;
        }

        .sidebar-menu {
            margin-top: 2rem;
            list-style: none;
            padding: 0;
        }

        .sidebar-menu li {
            margin: 0.5rem 0;
        }

        .sidebar-menu a {
            background: #ffffff;
            color: #000000;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            cursor: pointer;
        }

        .sidebar-menu a:hover {
            background: #f5f5f5;
            transform: translateX(5px);
        }

        .sidebar-menu a.active {
            background: #e8eaf6;
            color: #1a237e;
            font-weight: 600;
        }

        .sidebar-menu i {
            width: 20px;
            text-align: center;
            color: #1a237e;
        }

        /* Responsive styles */
        @media screen and (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .menu-toggle {
                display: flex;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 1001;
                background: #1a237e;
                color: white;
                padding: 0.8rem;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }

            .menu-toggle:hover {
                background: #151b60;
            }
        }

        /* Çıkış butonu özel stili */
        .sidebar-menu a.logout-link {
            background: #ffebee;
            color: #c62828;
        }

        .sidebar-menu a.logout-link:hover {
            background: #ffcdd2;
        }

        .sidebar-menu a.logout-link i {
            color: #c62828;
        }

        .main-content {
            margin-left: 250px;
            padding: 2rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #333;
        }

        .card-header i {
            font-size: 1.5rem;
            color: #764ba2;
        }

        #settingsContent, #profileContent {
            display: none;
        }

        .stats-content {
            display: grid;
            gap: 1rem;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #764ba2;
        }

        .recent-jobs {
            max-height: 300px;
            overflow-y: auto;
        }

        .job-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px var(--shadow-color);
            transition: all 0.3s ease;
        }

        .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }

        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .employer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .employer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .employer-details h3 {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .location {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .job-price {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            background: var(--button-bg);
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
        }

        .job-content {
            margin-bottom: 15px;
        }

        .job-content h4 {
            color: var(--text-primary);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .job-content p {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .full-address {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .job-footer {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .job-footer span {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .status.active {
            color: #4CAF50;
        }

        .status.inactive {
            color: #f44336;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-primary);
        }

        .error {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .no-jobs {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .category-stats {
            display: grid;
            gap: 0.5rem;
        }

        .category-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .jobs-container {
            display: grid;
            gap: 1.5rem;
            padding: 1rem;
        }

        .job-card-large {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .job-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .job-user-avatar {
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .job-price-tag {
            background: #4CAF50;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
        }

        .job-details {
            margin-bottom: 1rem;
        }

        .job-details h3 {
            color: #333;
            margin-bottom: 0.5rem;
        }

        .job-details p {
            color: #666;
            font-size: 0.9rem;
        }

        .job-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }

        .job-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            font-size: 0.9rem;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }

        .settings-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .settings-content {
            margin-top: 1rem;
        }

        .setting-item {
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: #333;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .setting-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
        }

        .setting-button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            background: #764ba2;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .setting-button:hover {
            background: #5f3d82;
        }

        .setting-button.danger {
            background: #dc3545;
        }

        .setting-button.danger:hover {
            background: #c82333;
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: #764ba2;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .danger-zone {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px dashed #dc3545;
        }

        /* Responsive Tasarım */
        @media screen and (max-width: 1024px) {
            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 1000;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .menu-toggle {
                display: flex;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 1001;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                padding: 0.5rem;
                border-radius: 5px;
                border: none;
                color: white;
                cursor: pointer;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media screen and (max-width: 768px) {
            .nav-content {
                flex-direction: column;
                gap: 1rem;
            }

            .user-details {
                grid-template-columns: 1fr;
            }

            .welcome-card {
                margin: 1rem;
                padding: 1rem;
            }

            .job-card {
                flex-direction: column;
            }

            .job-meta {
                flex-wrap: wrap;
                justify-content: flex-start;
                gap: 0.5rem;
            }

            .settings-card {
                margin: 1rem 0;
            }

            .job-card-large {
                padding: 1rem;
            }

            .job-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .job-price-tag {
                align-self: flex-end;
            }

            .job-meta {
                gap: 0.8rem;
            }
        }

        @media screen and (max-width: 480px) {
            .detail-item {
                padding: 0.8rem;
            }

            .setting-button {
                width: 100%;
                margin-top: 0.5rem;
            }

            .job-price-tag {
                width: 100%;
                text-align: center;
                margin-top: 0.5rem;
            }

            .stat-item {
                padding: 0.8rem;
            }
        }

        .sidebar-menu .share-job-btn {
            background: #4CAF50;  /* Yeşil tonu */
            color: white;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .sidebar-menu .share-job-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .sidebar-menu .share-job-btn i {
            color: white;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 6px var(--shadow-color);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--button-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .stat-info {
            flex: 1;
        }

        .stat-info span {
            display: block;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Mobil için responsive tasarım */
        @media screen and (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media screen and (max-width: 480px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
        }

        /* Hata mesajı stili */
        .error-message {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .error-message p {
            margin: 5px 0;
        }

        .error-message small {
            color: var(--text-secondary);
        }

        .search-job-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            margin: 0.5rem 0;
        }

        .search-job-btn:hover {
            background: linear-gradient(135deg, #45a049 0%, #4CAF50 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="user-info">
            <i class="fas fa-user"></i>
            <span id="userDisplayName">Loading...</span>
        </div>
        <ul class="sidebar-menu">
            <li>
                <a href="#" class="share-job-btn" onclick="window.location.href='share-job.html'">
                    <i class="fas fa-plus-circle"></i> İş Paylaş
                </a>
            </li>
            <li>
                <a href="#" onclick="window.location.href='searchjob.html'" class="search-job-btn">
                    <i class="fas fa-search"></i> İş Ara
                </a>
            </li>
            <li><a href="#" class="active" onclick="showContent('dashboard')">
                <i class="fas fa-home"></i> Dashboard</a>
            </li>
            <li><a href="#" onclick="showContent('statistics')">
                <i class="fas fa-chart-bar"></i> İstatistikler</a>
            </li>
            <li><a href="#" onclick="showContent('profile')">
                <i class="fas fa-user-circle"></i> Profil</a>
            </li>
            <li><a href="#" onclick="showContent('settings')">
                <i class="fas fa-cog"></i> Ayarlar</a>
            </li>
            <li><a href="#" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Çıkış Yap</a>
            </li>
        </ul>
    </div>

    <div class="main-content">
        <div id="dashboardContent">
            <h1>Paylaşılan İşler</h1>
            <div class="container">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <div class="stat-info">
                            <span id="totalJobs">0</span>
                            <p>Toplam İş</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <span id="activeJobs">0</span>
                            <p>Aktif İş</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <span id="completedJobs">0</span>
                            <p>Tamamlanan İş</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="stat-info">
                            <span id="totalLikes">0</span>
                            <p>Toplam Beğeni</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jobs-container" id="allJobs">
                <div class="loading">Yükleniyor...</div>
            </div>
        </div>

        <div id="statisticsContent" style="display: none;">
            <h1>İstatistikler</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-chart-line"></i>
                        <h2>İş İstatistikleri</h2>
                    </div>
                    <div class="stats-content">
                        <div class="stat-item">
                            <div class="stat-label">Toplam İş İlanı</div>
                            <div class="stat-value" id="totalJobs">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Aktif İlanlar</div>
                            <div class="stat-value" id="activeJobs">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Toplam Kazanç</div>
                            <div class="stat-value" id="totalEarnings">₺0</div>
                        </div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-tasks"></i>
                        <h2>Son İşler</h2>
                    </div>
                    <div class="recent-jobs" id="recentJobs">
                        <div class="loading">Yükleniyor...</div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-chart-pie"></i>
                        <h2>Kategori Dağılımı</h2>
                    </div>
                    <div class="category-stats" id="categoryStats">
                    </div>
                </div>
            </div>
        </div>

        <div id="profileContent">
            <div class="welcome-card">
                <h1 class="welcome-title">Profil Bilgileri</h1>
                <div class="user-details">
                    <div class="detail-item">
                        <div class="detail-label">Ad Soyad</div>
                        <div class="detail-value" id="fullNameValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Kullanıcı Adı</div>
                        <div class="detail-value" id="usernameValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">E-posta</div>
                        <div class="detail-value" id="emailValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Telefon Numarası</div>
                        <div class="detail-value" id="phoneNumberValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Telefon Doğrulama</div>
                        <div class="detail-value" id="phoneVerifiedValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Referans Kodu</div>
                        <div class="detail-value" id="referralCodeValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Kullanıcı Rolü</div>
                        <div class="detail-value" id="roleValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Hesap Durumu</div>
                        <div class="detail-value" id="isActiveValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Kayıt Tarihi</div>
                        <div class="detail-value" id="createdAtValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Son Giriş</div>
                        <div class="detail-value" id="lastLoginValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Son Güncelleme</div>
                        <div class="detail-value" id="lastUpdatedValue">Yükleniyor...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Cihaz Bilgileri</div>
                        <div class="detail-value" id="deviceInfoValue">Yükleniyor...</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="settingsContent">
            <h1>Ayarlar</h1>
            <div class="settings-grid">
                <!-- Görünüm Ayarları -->
                <div class="settings-card">
                    <div class="card-header">
                        <i class="fas fa-palette"></i>
                        <h2>Görünüm Ayarları</h2>
                    </div>
                    <div class="settings-content">
                        <div class="setting-item">
                            <div class="setting-label">Tema</div>
                            <select class="setting-input" id="themeSelect">
                                <option value="light">Açık Tema</option>
                                <option value="dark">Koyu Tema</option>
                                <option value="system">Sistem Teması</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">Yazı Boyutu</div>
                            <select class="setting-input" id="fontSizeSelect">
                                <option value="small">Küçük</option>
                                <option value="medium">Orta</option>
                                <option value="large">Büyük</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Bildirim Ayarları -->
                <div class="settings-card">
                    <div class="card-header">
                        <i class="fas fa-bell"></i>
                        <h2>Bildirim Ayarları</h2>
                    </div>
                    <div class="settings-content">
                        <div class="setting-item">
                            <div class="setting-label">E-posta Bildirimleri</div>
                            <label class="switch">
                                <input type="checkbox" id="emailNotifications">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">Yeni İş İlanları</div>
                            <label class="switch">
                                <input type="checkbox" id="newJobNotifications">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">Mesaj Bildirimleri</div>
                            <label class="switch">
                                <input type="checkbox" id="messageNotifications">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Gizlilik Ayarları -->
                <div class="settings-card">
                    <div class="card-header">
                        <i class="fas fa-shield-alt"></i>
                        <h2>Gizlilik ve Güvenlik</h2>
                    </div>
                    <div class="settings-content">
                        <div class="setting-item">
                            <div class="setting-label">Profil Gizliliği</div>
                            <select class="setting-input" id="privacySelect">
                                <option value="public">Herkese Açık</option>
                                <option value="private">Gizli</option>
                                <option value="friends">Sadece Arkadaşlar</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">Konum Paylaşımı</div>
                            <label class="switch">
                                <input type="checkbox" id="locationSharing">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">İki Faktörlü Doğrulama</div>
                            <label class="switch">
                                <input type="checkbox" id="twoFactorAuth">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Hesap Ayarları -->
                <div class="settings-card">
                    <div class="card-header">
                        <i class="fas fa-user-cog"></i>
                        <h2>Hesap Ayarları</h2>
                    </div>
                    <div class="settings-content">
                        <div class="setting-item">
                            <div class="setting-label">Şifre Değiştir</div>
                            <button class="setting-button" onclick="window.location.href='change-password.html'">
                                <i class="fas fa-key"></i> Şifre Değiştir
                            </button>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">E-posta Değiştir</div>
                            <button class="setting-button" onclick="window.location.href='change-email.html'">
                                <i class="fas fa-envelope"></i> E-posta Değiştir
                            </button>
                        </div>
                        <div class="setting-item danger-zone">
                            <div class="setting-label">Hesabı Dondur</div>
                            <button class="setting-button danger" onclick="window.location.href='deactivate-account.html'">
                                <i class="fas fa-user-slash"></i> Hesabı Dondur
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Cihaz Ayarları -->
                <div class="settings-card">
                    <div class="card-header">
                        <i class="fas fa-mobile-alt"></i>
                        <h2>Cihaz Yönetimi</h2>
                    </div>
                    <div class="settings-content">
                        <div class="setting-item">
                            <div class="setting-label">Son Giriş Yapılan Cihaz</div>
                            <div class="device-info" id="lastLoginDevice">
                                Yükleniyor...
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-label">Bağlı Cihazlar</div>
                            <div class="connected-devices" id="connectedDevices">
                                Yükleniyor...
                            </div>
                        </div>
                        <div class="setting-item">
                            <button class="setting-button" onclick="window.location.href='settings.html#devices'">
                                <i class="fas fa-cogs"></i> Tüm Cihazları Yönet
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="menu-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <script type="module">
        import { auth, firestore } from './assets/js/firebaseConfig.js';
        import { 
            onAuthStateChanged, 
            signOut, 
            signInWithEmailAndPassword 
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { 
            collection, 
            getDocs, 
            doc as firestoreDoc,
            getDoc,
            query as firestoreQuery,
            where,
            orderBy
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        let isProcessing = false;

        onAuthStateChanged(auth, async (user) => {
            if (isProcessing) return;
            
            try {
                isProcessing = true;
                
                // QR session kontrolü
                const qrSessionData = localStorage.getItem('qrSession');
                
                if (!user && !qrSessionData) {
                    window.location.href = './register.html';
                    return;
                }

                if (!user && qrSessionData) {
                    // QR session varsa ve kullanıcı oturum açmamışsa
                    const qrSession = JSON.parse(qrSessionData);
                    try {
                        // Firestore'dan kullanıcı bilgilerini al
                        const userDoc = await getDoc(firestoreDoc(firestore, 'users', qrSession.uid));
                        if (userDoc.exists()) {
                            const userData = userDoc.data();
                            // Firebase Auth'da oturum aç
                            await signInWithEmailAndPassword(auth, userData.email, qrSession.uid);
                        } else {
                            throw new Error('Kullanıcı bulunamadı');
                        }
                    } catch (error) {
                        console.error('QR oturum hatası:', error);
                        localStorage.removeItem('qrSession');
                        window.location.href = './register.html';
                        return;
                    }
                }

                // Kullanıcı bilgilerini göster
                const userId = user?.uid || JSON.parse(qrSessionData)?.uid;
                
                if (!userId) {
                    console.error('Kullanıcı ID bulunamadı');
                    return;
                }

                try {
                    const userDoc = await getDoc(firestoreDoc(firestore, 'users', userId));
                    
                    const defaultValues = {
                        displayName: 'Belirtilmemiş',
                        email: 'Belirtilmemiş',
                        createdAt: 'Belirtilmemiş'
                    };

                    const userData = userDoc.exists() ? userDoc.data() : {};
                    
                    // Kullanıcı bilgilerini güncelle
                    document.getElementById('userDisplayName').textContent = 
                        userData.fullName || user?.displayName || defaultValues.displayName;
                    
                    document.getElementById('fullNameValue').textContent = 
                        userData.fullName || defaultValues.displayName;
                    
                    document.getElementById('usernameValue').textContent = 
                        userData.username || 'Belirtilmemiş';
                    
                    document.getElementById('emailValue').textContent = 
                        userData.email || defaultValues.email;
                    
                    document.getElementById('phoneNumberValue').textContent = 
                        userData.phoneNumber || 'Belirtilmemiş';
                    
                    document.getElementById('phoneVerifiedValue').textContent = 
                        userData.phoneVerified ? '✅ Doğrulanmış' : '❌ Doğrulanmamış';
                    
                    document.getElementById('referralCodeValue').textContent = 
                        userData.referralCode || 'Belirtilmemiş';
                    
                    document.getElementById('roleValue').textContent = 
                        userData.role || 'Belirtilmemiş';
                    
                    document.getElementById('isActiveValue').textContent = 
                        userData.isActive ? '✅ Aktif' : '❌ Pasif';
                    
                    document.getElementById('createdAtValue').textContent = 
                        userData.createdAt ? new Date(userData.createdAt.toDate()).toLocaleString('tr-TR') : defaultValues.createdAt;
                    
                    document.getElementById('lastLoginValue').textContent = 
                        userData.lastLogin ? new Date(userData.lastLogin.toDate()).toLocaleString('tr-TR') : 'Belirtilmemiş';
                    
                    document.getElementById('lastUpdatedValue').textContent = 
                        userData.lastUpdated ? new Date(userData.lastUpdated.toDate()).toLocaleString('tr-TR') : 'Belirtilmemiş';
                    
                    // Cihaz bilgilerini formatlayarak göster
                    if (userData.deviceInfo) {
                        const deviceInfo = `Platform: ${userData.deviceInfo.platform || 'Belirtilmemiş'}
                                          Versiyon: ${userData.deviceInfo.version || 'Belirtilmemiş'}`;
                        document.getElementById('deviceInfoValue').textContent = deviceInfo;
                    } else {
                        document.getElementById('deviceInfoValue').textContent = 'Cihaz bilgisi yok';
                    }

                } catch (error) {
                    console.error('Kullanıcı bilgileri alma hatası:', error);
                    // Hata durumunda tüm alanları "Belirtilmemiş" olarak işaretle
                    const fields = [
                        'userDisplayName', 'fullNameValue', 'usernameValue', 'emailValue',
                        'phoneNumberValue', 'phoneVerifiedValue', 'referralCodeValue',
                        'roleValue', 'isActiveValue', 'createdAtValue', 'lastLoginValue',
                        'lastUpdatedValue', 'deviceInfoValue'
                    ];
                    fields.forEach(field => {
                        document.getElementById(field).textContent = 'Belirtilmemiş';
                    });
                }

            } catch (error) {
                console.error('Genel hata:', error);
            } finally {
                isProcessing = false;
            }
        });

        window.logout = async () => {
            try {
                localStorage.removeItem('qrSession');
                await signOut(auth);
                window.location.replace('./register.html');
            } catch (error) {
                console.error('Çıkış hatası:', error);
                alert('Çıkış yapılırken hata oluştu');
            }
        };

        // Yeni JavaScript fonksiyonu
        window.showContent = (contentType) => {
            document.getElementById('dashboardContent').style.display = 'none';
            document.getElementById('statisticsContent').style.display = 'none';
            document.getElementById('profileContent').style.display = 'none';
            document.getElementById('settingsContent').style.display = 'none';
            
            document.getElementById(`${contentType}Content`).style.display = 'block';
            
            // Aktif menü öğesini güncelle
            document.querySelectorAll('.sidebar-menu a').forEach(a => {
                a.classList.remove('active');
                if(a.getAttribute('onclick').includes(contentType)) {
                    a.classList.add('active');
                }
            });
        };

        // İş istatistiklerini yükleme fonksiyonu
        async function loadJobStats(userId) {
            try {
                console.log('İş istatistikleri yükleniyor...', { userId });
                
                if (!userId) {
                    throw new Error('Kullanıcı ID\'si bulunamadı');
                }

                // İstatistik elementlerini bul
                const totalJobsElement = document.getElementById('totalJobs');
                const activeJobsElement = document.getElementById('activeJobs');
                const completedJobsElement = document.getElementById('completedJobs');
                const totalLikesElement = document.getElementById('totalLikes');

                if (!totalJobsElement || !activeJobsElement || !completedJobsElement || !totalLikesElement) {
                    throw new Error('İstatistik elementleri bulunamadı');
                }

                console.log('İstatistik sorguları oluşturuluyor...');

                // Tüm işleri sorgula
                const jobsQuery = firestoreQuery(
                    collection(firestore, 'jobs'),
                    where('employerId', '==', userId)
                );

                console.log('İşler sorgulanıyor...');
                const querySnapshot = await getDocs(jobsQuery);
                console.log(`${querySnapshot.docs.length} adet iş bulundu`);

                // İstatistikleri hesapla
                let totalJobs = 0;
                let activeJobs = 0;
                let completedJobs = 0;
                let totalLikes = 0;

                querySnapshot.forEach(doc => {
                    const jobData = doc.data();
                    totalJobs++;
                    
                    if (jobData.status === 'active') activeJobs++;
                    if (jobData.status === 'completed') completedJobs++;
                    
                    totalLikes += jobData.likes || 0;
                });

                console.log('İstatistikler hesaplandı:', {
                    totalJobs,
                    activeJobs,
                    completedJobs,
                    totalLikes
                });

                // İstatistikleri göster
                totalJobsElement.textContent = totalJobs;
                activeJobsElement.textContent = activeJobs;
                completedJobsElement.textContent = completedJobs;
                totalLikesElement.textContent = totalLikes;

                console.log('İstatistikler başarıyla güncellendi');

            } catch (error) {
                console.error('İş istatistikleri yüklenirken hata:', {
                    error: error,
                    message: error.message,
                    stack: error.stack,
                    userId: userId,
                    errorCode: error.code,
                    errorName: error.name
                });

                // Hata durumunda kullanıcıya göster
                const statsContainer = document.querySelector('.stats-container');
                if (statsContainer) {
                    statsContainer.innerHTML = `
                        <div class="error-message">
                            <p>İstatistikler yüklenirken bir hata oluştu:</p>
                            <p>${error.message}</p>
                            <small>Hata Kodu: ${error.code || 'Bilinmiyor'}</small>
                        </div>
                    `;
                }
            }
        }

        // Tüm işleri yükleme fonksiyonu
        async function loadAllJobs() {
            try {
                console.log('İşler yüklenmeye başlıyor...');
                const jobsContainer = document.getElementById('allJobs');
                if (!jobsContainer) {
                    throw new Error('allJobs ID\'li container bulunamadı!');
                }

                jobsContainer.innerHTML = '<div class="loading">İşler yükleniyor...</div>';

                console.log('Firestore\'dan işler çekiliyor...');
                const querySnapshot = await getDocs(collection(firestore, 'jobs'));
                console.log(`${querySnapshot.docs.length} adet iş bulundu`);

                jobsContainer.innerHTML = '';

                for (const doc of querySnapshot.docs) {
                    try {
                        console.log(`İş ID: ${doc.id} işleniyor...`);
                        const jobData = doc.data();
                        
                        if (!jobData.employerId) {
                            console.error(`İş ID: ${doc.id} için employerId bulunamadı`);
                            continue;
                        }

                        console.log(`Kullanıcı bilgileri çekiliyor... (EmployerId: ${jobData.employerId})`);
                        const userRef = firestoreDoc(firestore, 'users', jobData.employerId);
                        const userSnapshot = await getDoc(userRef);
                        
                        if (!userSnapshot.exists()) {
                            console.warn(`Kullanıcı bulunamadı: ${jobData.employerId}`);
                        }
                        
                        const userData = userSnapshot.exists() ? userSnapshot.data() : {};
                        console.log('Kullanıcı bilgileri:', userData);

                        // İş kartı HTML'i oluştur
                        const jobCard = `
                            <div class="job-card">
                                <div class="job-header">
                                    <div class="employer-info">
                                        <img src="${userData.photoURL || 'assets/images/default-avatar.png'}" 
                                             alt="Profil" 
                                             class="employer-avatar">
                                        <div class="employer-details">
                                            <h3>${userData.username || 'İsimsiz Kullanıcı'}</h3>
                                            <p class="location">
                                                <i class="fas fa-map-marker-alt"></i>
                                                ${jobData.neighborhood || 'Konum belirtilmemiş'}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="job-price">₺${jobData.jobPrice?.toLocaleString('tr-TR')}</div>
                                </div>
                                <div class="job-content">
                                    <h4>${jobData.jobName}</h4>
                                    <p>${jobData.jobDescription}</p>
                                    ${jobData.fullAddress ? 
                                        `<p class="full-address">
                                            <i class="fas fa-map"></i> ${jobData.fullAddress}
                                        </p>` : ''
                                    }
                                </div>
                                <div class="job-footer">
                                    <span class="category">
                                        <i class="fas fa-tag"></i> ${jobData.category}
                                    </span>
                                    <span class="status ${jobData.status}">
                                        <i class="fas fa-circle"></i> ${jobData.status === 'active' ? 'Aktif' : 'Pasif'}
                                    </span>
                                    <span class="likes">
                                        <i class="fas fa-heart"></i> ${jobData.likes || 0}
                                    </span>
                                    <span class="comments">
                                        <i class="fas fa-comment"></i> ${jobData.comments || 0}
                                    </span>
                                    <span class="date">
                                        <i class="fas fa-clock"></i> 
                                        ${new Date(jobData.createdAt).toLocaleDateString('tr-TR')}
                                    </span>
                                </div>
                            </div>
                        `;
                        
                        jobsContainer.innerHTML += jobCard;
                        console.log(`İş ID: ${doc.id} başarıyla eklendi`);

                    } catch (docError) {
                        console.error('Belge işlenirken hata:', {
                            error: docError,
                            errorMessage: docError.message,
                            errorStack: docError.stack,
                            documentId: doc.id,
                            documentData: doc.data()
                        });
                        continue;
                    }
                }

                if (jobsContainer.innerHTML === '') {
                    jobsContainer.innerHTML = '<div class="no-jobs">Henüz iş ilanı bulunmuyor</div>';
                }

            } catch (error) {
                console.error('İşler yüklenirken kritik hata:', error);
                const jobsContainer = document.getElementById('allJobs');
                if (jobsContainer) {
                    jobsContainer.innerHTML = `
                        <div class="error">
                            <p>Veriler yüklenirken bir hata oluştu:</p>
                            <p class="error-message">${error.message}</p>
                        </div>
                    `;
                }
            }
        }

        // Auth state değişikliğinde işleri ve istatistikleri yükle
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                console.log('Kullanıcı oturum açtı, veriler yükleniyor...');
                try {
                    await loadAllJobs();
                    await loadJobStats(user.uid);
                } catch (error) {
                    console.error('Veri yükleme hatası:', error);
                }
            }
        });

        // Ayarları kaydetme fonksiyonu
        async function saveSettings() {
            try {
                const settings = {
                    theme: document.getElementById('themeSelect').value,
                    fontSize: document.getElementById('fontSizeSelect').value,
                    emailNotifications: document.getElementById('emailNotifications').checked,
                    newJobNotifications: document.getElementById('newJobNotifications').checked,
                    messageNotifications: document.getElementById('messageNotifications').checked,
                    privacy: document.getElementById('privacySelect').value,
                    locationSharing: document.getElementById('locationSharing').checked,
                    twoFactorAuth: document.getElementById('twoFactorAuth').checked
                };

                const user = auth.currentUser;
                if (user) {
                    await setDoc(firestoreDoc(firestore, 'userSettings', user.uid), settings);
                    alert('Ayarlar başarıyla kaydedildi!');
                }
            } catch (error) {
                console.error('Ayarlar kaydedilirken hata:', error);
                alert('Ayarlar kaydedilirken bir hata oluştu!');
            }
        }

        // Ayarları yükleme fonksiyonu
        async function loadSettings() {
            try {
                const user = auth.currentUser;
                if (user) {
                    const settingsDoc = await getDoc(firestoreDoc(firestore, 'userSettings', user.uid));
                    if (settingsDoc.exists()) {
                        const settings = settingsDoc.data();
                        document.getElementById('themeSelect').value = settings.theme || 'light';
                        document.getElementById('fontSizeSelect').value = settings.fontSize || 'medium';
                        document.getElementById('emailNotifications').checked = settings.emailNotifications || false;
                        document.getElementById('newJobNotifications').checked = settings.newJobNotifications || false;
                        document.getElementById('messageNotifications').checked = settings.messageNotifications || false;
                        document.getElementById('privacySelect').value = settings.privacy || 'public';
                        document.getElementById('locationSharing').checked = settings.locationSharing || false;
                        document.getElementById('twoFactorAuth').checked = settings.twoFactorAuth || false;
                    }
                }
            } catch (error) {
                console.error('Ayarlar yüklenirken hata:', error);
            }
        }

        // Auth state değişikliğinde ayarları yükle
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                await loadSettings();
            }
        });

        // Global scope'a toggleSidebar fonksiyonunu ekle
        window.toggleSidebar = function() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('active');
        };

        // Event listener'ı güncelle
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.querySelector('.main-content');
            if (mainContent) {
                mainContent.addEventListener('click', () => {
                    const sidebar = document.querySelector('.sidebar');
                    if (sidebar && sidebar.classList.contains('active')) {
                        sidebar.classList.remove('active');
                    }
                });
            }
        });
    </script>
</body>
</html> 